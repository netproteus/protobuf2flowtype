machine:
  node:
    version: 6.5.0

dependencies:
  pre:
    - echo -e "$NPM_USER\n$NPM_PASS\n$NPM_EMAIL" | npm login
  override:
    - npm install --dev

test:
  post:
    - cp coverage/lcov.info ${CIRCLE_ARTIFACTS}
    - perl -pe 's/\/home\/ubuntu\/protobuf2flowtype/\/Users\/william\/work\/protobuf2flowtype/g' -i coverage/lcov.info
    - node_modules/.bin/codecov --disable=gcov -t ${CODECOV_TOKEN}

deployment:
  release:
    tag: /v\d+\.\d+\.\d+/
    owner: netproteus
    commands:
      - npm publish
      